# 数组乱序 & 洗牌算法

问题：存在一个长度为 10 的数组，数组里的成员分别是有序的 1-10，问如何将其打乱？

不用再回答这种方式了，已经被证明过并不随机：

```js
arr.sort((a, b) => Math.random() - 0.5)
```

也可以通过多次运行的方式明显看出，例如将这个乱序算法运行 10W 次：

```js
var result = new Array(10).fill(0).map(() => new Array(10).fill(0))
var shuffle = arr => arr.sort(() => Math.random() - 0.5)
var originArr = new Array(10).fill(0).map((_, index) => index + 1)
for (let i = 0; i < 100000; i++) {
  const res = shuffle([...originArr])
  for (let j = 0; j < 10; j++) {
    result[res[j] - 1][j]++
  }
}
```

最终得到结果如下：

|     | 1     | 2     | 3     | 4     | 5     | 6     | 7     | 8     | 9     | 10    |
| --- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| 1   | 19418 | 13705 | 9066  | 7440  | 6816  | 7308  | 8148  | 8355  | 9387  | 10357 |
| 2   | 7275  | 14529 | 13055 | 12272 | 11737 | 11874 | 10847 | 8920  | 6846  | 2645  |
| 3   | 9741  | 9569  | 9906  | 10106 | 10337 | 11395 | 11652 | 10383 | 9012  | 7899  |
| 4   | 12740 | 12572 | 9775  | 9812  | 9798  | 10536 | 10369 | 8991  | 8464  | 6943  |
| 5   | 8418  | 7807  | 7456  | 8485  | 10198 | 12547 | 12725 | 11923 | 11031 | 9410  |
| 6   | 8919  | 8772  | 10017 | 10877 | 10280 | 9770  | 9169  | 9096  | 10570 | 12530 |
| 7   | 9837  | 9740  | 8307  | 8483  | 8096  | 8777  | 9068  | 9192  | 11711 | 16789 |
| 8   | 11098 | 11083 | 9935  | 9226  | 9562  | 9901  | 10137 | 9818  | 9508  | 9732  |
| 9   | 6129  | 6040  | 10119 | 10871 | 10784 | 11547 | 11561 | 10893 | 11031 | 11025 |
| 10  | 6425  | 6183  | 12364 | 12428 | 12392 | 6345  | 6324  | 12429 | 12440 | 12670 |

## 乱序算法 1

根据数组长度取一个随机索引，将这个索引对应的数 push 到一个新数组里，并在原数组里将此数删除。当数组里的数取完时返回这个新数组即可。

```js
function shuffle(arr) {
  const result = []
  while (arr.length) {
    const randomIndex = Math.floor(Math.random() * arr.length)
    result.push(arr[randomIndex])
    arr.splice(randomIndex, 1)
  }
  return result
}
```

复杂度分析：

- 时间复杂度：O(N)
- 空间复杂度：O(N)

## 洗牌算法

倒序遍历数组，取遍历位置和该位置前面的随机一个数与遍历位置交换，遍历完成时返回原数组即可。

```js
function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const randomIndex = Math.floor(Math.random() * (i + 1))
    ;[arr[i], arr[randomIndex]] = [arr[randomIndex], arr[i]]
  }
  return arr
}
```
